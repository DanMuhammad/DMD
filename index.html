

  <!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Endless Coin Collector â€” DMD</title>
<style>
  :root{
    --bg1:#0f1724; --bg2:#071028; --card:#0b1221; --accent:#ffd166;
    --danger:#ff6b6b; --text:#e6eef8;
  }
  *{box-sizing:border-box}
  body{
    margin:0; min-height:100vh; font-family:Inter,system-ui,Arial,Helvetica;
    display:flex; align-items:center; justify-content:center;
    background: radial-gradient(circle at 10% 10%, #073b66 0%, #00121a 40%), linear-gradient(180deg,#001219 0%,#00172b 100%);
    color:var(--text);
    padding:20px;
  }
  .wrap{
    width:100%; max-width:820px; display:grid; grid-template-columns:320px 1fr; gap:18px;
  }
  .panel{
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.05));
    border-radius:12px; padding:14px; border:1px solid rgba(255,255,255,0.04);
  }
  .left{min-height:480px; display:flex;flex-direction:column; gap:10px}
  h1{margin:0 0 6px 0;font-size:20px}
  .stat{display:flex;justify-content:space-between;padding:8px 10px;border-radius:8px;background:rgba(255,255,255,0.02)}
  .big{font-size:22px;font-weight:700}
  #gameArea{position:relative;background:linear-gradient(180deg,#071028,#091427); border-radius:10px; height:520px; overflow:hidden; border:1px solid rgba(255,255,255,0.03)}
  .coin{
    position:absolute; width:64px; height:64px; cursor:pointer; user-select:none;
    transition:transform .12s ease, opacity .25s ease, left .2s linear, top .2s linear;
    will-change:left,top,transform,opacity;
    border-radius:50%;
    display:flex; align-items:center; justify-content:center;
    font-weight:700; color:#1b1b1b; text-shadow:0 1px 0 rgba(255,255,255,0.12);
    box-shadow: 0 8px 20px rgba(0,0,0,0.45);
  }
  /* GOLD coin (good) */
  .coin.good{
    background:
      radial-gradient(circle at 35% 28%, #fff7c9 0%, rgba(255,255,255,0) 20%),
      radial-gradient(circle at 60% 60%, rgba(255,200,50,0.8), rgba(255,140,30,0.95) 60%),
      linear-gradient(180deg,#ffd666 0%,#ffb84d 100%);
    border: 1px solid rgba(255,255,255,0.12);
    box-shadow: 0 8px 20px rgba(0,0,0,0.45), inset 0 -4px 8px rgba(0,0,0,0.08);
  }
  /* RED coin (bad) */
  .coin.bad{
    background:
      radial-gradient(circle at 35% 28%, #fff0f0 0%, rgba(255,255,255,0) 20%),
      linear-gradient(180deg,#ff8a8a 0%,#ff5b5b 60%,#ff3737 100%);
    border: 1px solid rgba(0,0,0,0.15);
    color:#fff;
    box-shadow: 0 8px 20px rgba(0,0,0,0.5), inset 0 -4px 8px rgba(0,0,0,0.12);
  }

  .coin:active{ transform: scale(1.08); }

  .controls{display:flex; gap:8px; margin-top:6px}
  button{padding:8px 12px;border-radius:8px;border:0;background:#1f6feb;color:#fff;cursor:pointer}
  button.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06)}
  .footer-note{font-size:12px;color:#9fb3d6;margin-top:8px}
  .top-row{display:flex;gap:8px;align-items:center; justify-content:space-between}
  .center-col{display:flex;flex-direction:column;gap:10px}
  .small{font-size:13px;color:#9fb3d6}
  .level-badge{background:linear-gradient(90deg,#ffd166,#ffb86b);color:#0b1221;padding:6px 10px;border-radius:999px;font-weight:700}
  @media(max-width:880px){ .wrap{grid-template-columns:1fr} .left{order:2} }
</style>
</head>
<body>
  <div class="wrap">
    <div class="panel left">
      <div class="top-row">
        <div>
          <h1>Endless Coin Collector</h1>
          <div class="small">No limits â€” difficulty increases as you score</div>
        </div>
        <div class="level-badge" id="levelBadge">Lv 1</div>
      </div>

      <div style="margin-top:10px">
        <div class="stat"><div>Score</div><div class="big" id="score">0</div></div>
        <div style="height:8px"></div>
        <div class="stat"><div>High Score</div><div id="high">0</div></div>
        <div style="height:8px"></div>
        <div class="stat"><div>Time survived</div><div id="time">0s</div></div>
        <div style="height:8px"></div>
        <div class="stat"><div>Coins on screen</div><div id="onScreen">0</div></div>

        <div class="controls">
          <button id="pauseBtn">Pause</button>
          <button id="restartBtn" class="ghost">Restart</button>
          <button id="resetHS" class="ghost">Reset HS</button>
        </div>

        <div class="footer-note">
          Tips: Tap/click gold coins to gain points. Avoid red coins (they subtract). Difficulty ramps up every 10 points.
        </div>
      </div>
    </div>

    <div class="panel center-col">
      <div id="gameArea" aria-label="game area"></div>
      <div style="display:flex;gap:12px;align-items:center;justify-content:flex-end;margin-top:8px">
        <div class="small">Controls: Tap / Click coins</div>
      </div>
    </div>
  </div>

<script>
(() => {
  // Config
  const BASE_SPAWN_INTERVAL = 1400; // ms initial
  const MIN_SPAWN_INTERVAL = 380; // ms cap
  const BASE_BAD_CHANCE = 0.08; // chance of bad coin at low levels
  const MAX_BAD_CHANCE = 0.33; // at higher levels
  const MAX_COINS_ON_SCREEN = 9;

  // DOM
  const gameArea = document.getElementById('gameArea');
  const scoreEl = document.getElementById('score');
  const highEl = document.getElementById('high');
  const timeEl = document.getElementById('time');
  const levelBadge = document.getElementById('levelBadge');
  const onScreenEl = document.getElementById('onScreen');

  const pauseBtn = document.getElementById('pauseBtn');
  const restartBtn = document.getElementById('restartBtn');
  const resetHS = document.getElementById('resetHS');

  // State
  let score = 0;
  let high = parseInt(localStorage.getItem('dmd_high')||'0',10);
  highEl.textContent = high;
  let startTime = Date.now();
  let spawnTimer = null;
  let moveTimer = null;
  let paused = false;
  let coinsOnScreen = [];

  // Sounds (optional)
  const ding = new Audio('https://www.soundjay.com/buttons/sounds/button-09.mp3');
  ding.volume = 0.9;
  const badSound = new Audio('https://www.soundjay.com/button/sounds/button-10.mp3');
  badSound.volume = 0.9;

  // Helpers
  function getLevel(){ return Math.floor(score/10)+1; }
  function difficultyFactor(){ const level = getLevel(); return Math.min(1, level/100); }
  function currentSpawnInterval(){
    const f = difficultyFactor();
    return Math.max(MIN_SPAWN_INTERVAL, BASE_SPAWN_INTERVAL - f*(BASE_SPAWN_INTERVAL-MIN_SPAWN_INTERVAL));
  }
  function currentBadChance(){ const f = difficultyFactor(); return BASE_BAD_CHANCE + f*(MAX_BAD_CHANCE-BASE_BAD_CHANCE); }

  function updateUI(){
    scoreEl.textContent = score;
    highEl.textContent = high;
    const elapsedSec = Math.floor((Date.now()-startTime)/1000);
    timeEl.textContent = elapsedSec + 's';
    levelBadge.textContent = 'Lv ' + getLevel();
    onScreenEl.textContent = coinsOnScreen.length;
  }

  function randomPos(size){
    const pad = 6;
    const areaW = Math.max(100, gameArea.clientWidth - size - pad);
    const areaH = Math.max(100, gameArea.clientHeight - size - pad);
    const x = pad + Math.random()*areaW;
    const y = pad + Math.random()*areaH;
    return {x,y};
  }

  function makeCoinElement(isBad){
    const el = document.createElement('div');
    el.className = 'coin ' + (isBad ? 'bad' : 'good');
    el.style.width = (isBad?54:64) + 'px';
    el.style.height = (isBad?54:64) + 'px';
    el.setAttribute('role','button');
    el.setAttribute('aria-label', isBad? 'bad coin' : 'gold coin');
    // optional inner label / icon
    el.innerHTML = isBad ? 'âˆ’' : 'ðŸª™';
    el.style.fontSize = isBad ? '22px' : '24px';
    return el;
  }

  function spawnCoin(){
    if(paused) return;
    if(coinsOnScreen.length >= MAX_COINS_ON_SCREEN) return;
    const isBad = Math.random() < currentBadChance();
    const el = makeCoinElement(isBad);
    const size = parseInt(el.style.width,10);
    const pos = randomPos(size);
    el.style.left = pos.x + 'px';
    el.style.top = pos.y + 'px';
    el.style.opacity = '0';

    // click handler
    const onClick = (ev) => {
      ev.stopPropagation();
      if(paused) return;
      if(isBad){
        score = Math.max(0, score - Math.max(1, Math.floor(getLevel()/2)));
        try { badSound.play(); } catch(e){}
      } else {
        score++;
        try { ding.play(); } catch(e){}
      }
      el.style.transform = 'scale(1.12)';
      setTimeout(()=> el.style.transform = '', 120);
      removeCoin(el);
      afterScoreChange();
    };

    el.addEventListener('click', onClick);

    // lifetime / despawn
    const life = Math.max(2200, 6000 - getLevel()*35);
    const desp = setTimeout(()=> { removeCoin(el); }, life);

    gameArea.appendChild(el);
    coinsOnScreen.push({el, desp});
    requestAnimationFrame(()=> el.style.opacity = 1);
    updateUI();
  }

  function removeCoin(el){
    const idx = coinsOnScreen.findIndex(c=>c.el===el);
    if(idx!==-1){
      clearTimeout(coinsOnScreen[idx].desp);
      coinsOnScreen.splice(idx,1);
    }
    if(el && el.parentNode) el.parentNode.removeChild(el);
    updateUI();
  }

  function afterScoreChange(){
    if(score > high){ high = score; localStorage.setItem('dmd_high', String(high)); }
    resetSpawnTimer();
    updateUI();
  }

  function resetSpawnTimer(){
    if(spawnTimer) clearInterval(spawnTimer);
    const interval = Math.round(currentSpawnInterval());
    spawnTimer = setInterval(()=> {
      const extra = Math.floor(getLevel()/25);
      const times = Math.max(1, 1 + extra);
      for(let i=0;i<times;i++) spawnCoin();
    }, interval);
  }

  function startMovingCycle(){
    if(moveTimer) clearInterval(moveTimer);
    moveTimer = setInterval(()=> {
      coinsOnScreen.forEach(c=>{
        const el = c.el;
        const offset = Math.min(28, 5 + getLevel()*0.25);
        const nx = Math.max(6, Math.min(gameArea.clientWidth - parseFloat(el.style.width||64), parseFloat(el.style.left||0) + (Math.random()*offset - offset/2)));
        const ny = Math.max(6, Math.min(gameArea.clientHeight - parseFloat(el.style.height||64), parseFloat(el.style.top||0) + (Math.random()*offset - offset/2)));
        el.style.left = nx + 'px';
        el.style.top = ny + 'px';
      });
    }, 600);
  }

  function startGame(){
    // reset
    score = 0;
    startTime = Date.now();
    // clear any existing
    coinsOnScreen.slice().forEach(c=> {
      clearTimeout(c.desp); if(c.el && c.el.parentNode) c.el.parentNode.removeChild(c.el);
    });
    coinsOnScreen = [];
    paused = false;
    resetSpawnTimer();
    startMovingCycle();
    updateUI();
  }

  function pauseToggle(){
    paused = !paused;
    if(paused){
      pauseBtn.textContent = 'Resume';
      clearInterval(spawnTimer);
      clearInterval(moveTimer);
      coinsOnScreen.forEach(c=> clearTimeout(c.desp));
    } else {
      pauseBtn.textContent = 'Pause';
      resetSpawnTimer();
      startMovingCycle();
    }
  }

  function restart(){
    if(spawnTimer) clearInterval(spawnTimer);
    if(moveTimer) clearInterval(moveTimer);
    coinsOnScreen.slice().forEach(c=> {
      clearTimeout(c.desp); if(c.el && c.el.parentNode) c.el.parentNode.removeChild(c.el);
    });
    coinsOnScreen = [];
    score = 0;
    startTime = Date.now();
    resetSpawnTimer();
    startMovingCycle();
    updateUI();
  }

  pauseBtn.addEventListener('click', pauseToggle);
  restartBtn.addEventListener('click', restart);
  resetHS.addEventListener('click', ()=> {
    if(confirm('Reset high score?')) { localStorage.setItem('dmd_high','0'); high=0; highEl.textContent='0'; }
  });

  // start everything
  startGame();
  setInterval(updateUI, 500);

  // responsive behaviour (small screens)
  window.addEventListener('resize', ()=> { /* coins reposition by movement cycle */ });

})();
</script>
</body>
</html>
